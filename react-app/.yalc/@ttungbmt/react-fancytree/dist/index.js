var e=require("react"),t=require("clsx"),r=require("lodash"),n=require("jquery");require("jquery-ui"),require("jquery.fancytree"),require("jquery.fancytree/dist/modules/jquery.fancytree.filter"),require("jquery.fancytree/dist/modules/jquery.fancytree.glyph");var i=require("constate"),a=require("use-immer");require("immer");var l=require("@ttungbmt/tree-js");function u(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var o=u(e),d=u(t),c=u(r),s=u(n);function f(){return(f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function p(e,t){if(null==e)return{};var r,n,i={},a=Object.keys(e);for(n=0;n<a.length;n++)t.indexOf(r=a[n])>=0||(i[r]=e[r]);return i}var y={loading:!1,ids:[],entities:{}},m={setLoading:function(e,t){return e.loading=t.payload},setAll:function(e,t){e.entities=r.mapKeys(t.payload,"id"),function(e){e.ids=r.keys(e.entities)}(e)},select:function(e,t){var r=t.payload;r.ids.map(function(t){return e.entities[t].selected=r.selected})},selectOne:function(e,t){var r=t.payload,n=r.ids,i=r.selected;r.siblingIds.map(function(t){return e.entities[t].selected=!i}),n.map(function(t){return e.entities[t].selected=i})},setExpand:function(e,t){var r=t.payload;e.entities[r]&&(e.entities[r].expanded=!0)},setCollapse:function(e,t){var r=t.payload;e.entities[r]&&(e.entities[r].expanded=!1)}},v=function(e,t){m[t.type](e,t)},h=u(i).default(function(){var t=a.useImmerReducer(v,y),n=t[0],i=t[1],u=e.useState(void 0),o=u[0],d=u[1],c=e.useCallback(function(){return f({},r.mapValues(m,function(e,t){return function(e){return i({type:t,payload:e})}}),{expandAll:function(){return o.expandAll()},collapseAll:function(){return o.expandAll(!1)},toggleExpandAll:function(){return o.visit(function(e){return e.toggleExpanded()})}})},[o]);return f({},c(),{tree:o,setTree:d,dispatch:i,source:l.toTree(n.ids.map(function(e){return n.entities[e]}))})}),x=h[0],g=h[1],q=["blurTree","create","init","focusTree","restore","activate","beforeActivate","beforeExpand","beforeSelect","blur","click","collapse","createNode","dblclick","deactivate","expand","focus","keydown","keypress","lazyLoad","loadChildren","loadError","postProcess","modifyChild","renderNode","renderTitle","select"],b=function e(t,r){if(c.default.isArray(t))return t.map(function(t,r){return e(t,r+1)});var n=t.children,i=t.tooltip,a=t.title,l=t.data,u=void 0===l?{}:l,s=p(t,["children","tooltip","title","count","data"]),y=c.default.isNil(s.folder)?c.default.isArray(n)&&!c.default.isEmpty(n):s.folder;return o.default.createElement("li",{key:r,id:"ft"+r,title:i,className:d.default("relative",{folder:y}),"data-json":JSON.stringify(f({},s,u))},a,c.default.isArray(n)?o.default.createElement("ul",null,n.map(function(t,n){return e(t,r+"."+(n+1))})):null)};function E(t){var r=t.id,n=t.style,i=t.className,a=t.children,l=t.source,u=p(t,["id","style","className","children","source"]),y=e.useRef(null);return function(t,r){var n=g().setTree,i=c.default.omit(r.options,q)||{};e.useEffect(function(){if(t.current){var e=function(e){return c.default.chain(q).mapKeys(function(e){return e}).mapValues(function(t){return function(){var r="on"+c.default.upperFirst(t);e[r]&&e[r].apply(e,[].slice.call(arguments))}}).value()}(r);s.default(t.current).fancytree(f({},e,i,{renderNode:function(e,t){var r=t.node,n=s.default(r.span).find(".label-feature-count"),i=r.data.count;i&&!n.length&&s.default(r.span).append(s.default('<div class="label-feature-count">'+i+"</div>"))}})),n(s.default.ui.fancytree.getTree(t.current))}},[])}(y,u),o.default.createElement("div",{id:r,className:d.default(i),style:n,ref:y},a||o.default.createElement("ul",{style:{display:"none"}},b(l)))}E.defaultProps={options:{checkbox:!0,selectMode:3,quicksearch:!0,icon:!0,clickFolderMode:3,checkboxAutoHide:!1,disabled:!1,wide:{iconWidth:"3em",iconSpacing:"0.5em",labelSpacing:"0.1em",levelOfs:"1.5em"},filter:{autoApply:!0,autoExpand:!1,counter:!0,fuzzy:!1,hideExpandedCounter:!0,hideExpanders:!1,highlight:!0,leavesOnly:!1,nodata:!0,mode:"dimm"},childcounter:{deep:!0,hideZeros:!0,hideExpanded:!0},extensions:["filter"]}};var j=e.memo(E);exports.FancyTree=j,exports.TreeProvider=x,exports.getToggleFiles=function(e){if(e.isFolder()){var t=[];return e.visit(function(e){!e.isFolder()&&t.push(e)}),t}return[e]},exports.useTreeContext=g;
//# sourceMappingURL=index.js.map
